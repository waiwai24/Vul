# 1.漏洞描述：

**CVE-2023-2640** **：Ubuntu 内核权限提升漏洞（高危）**

在同时携带c914c0e27eb0和“Ubuntu:SAUCE:overlayfs:Skip permission checking for  trusted.overlayfs.*xattrs”的Ubuntu内核上，无特权用户可以在挂载的文件上设置特权扩展属性，从而导致在没有适当安全检查的情况下在上层文件上设置这些属性。

**CVE-2023-32629** **：Ubuntu 内核权限提升漏洞（高危）**

在Ubuntu 内核上调用 ovl_doo_setxattr 时，Ubuntu 内核 overlayfs ovl_copy_up_meta_inode_data 中存在跳过权限检查的本地权限提升漏洞。

# 2.影响范围:

* Ubuntu 23.04 (Lunar Lobster) Version 6.2.0
* Ubuntu 22.10 (Kinetic Kudu) Version 5.19.0
* Ubuntu 22.04 LTS (Jammy Jellyfish) Versions 5.19.0 and 6.2.0
* Ubuntu 20.04 LTS (Focal Fossa) Version 5.4.0 (Only affected by CVE-2023-32629)
* Ubuntu 18.04 LTS (Bionic Beaver) Version 5.4.0 (Only affected by CVE-2023-32629)
* Ubuntu 16.04 ESM
* Ubuntu 14.04 ESM

| Kernel version内核版本 | Ubuntu releaseUbuntu版本                                     |
| ---------------------- | ------------------------------------------------------------ |
| 6.2.0                  | Ubuntu 23.04 (Lunar Lobster) / Ubuntu 22.04 LTS (Jammy Jellyfish)Ubuntu 23.04(Lunar Lobster)/Ubuntu 22.04 LTS(Jammy Jellyfish) |
| 5.19.0                 | Ubuntu 22.10 (Kinetic Kudu) / Ubuntu 22.04 LTS (Jammy Jellyfish)Ubuntu 22.10(Kinetic Kudu)/Ubuntu 22.04 LTS(Jammy Jellyfish) |
| 5.4.0                  | Ubuntu 22.04 LTS (Local Fossa) / Ubuntu 18.04 LTS (Bionic Beaver)Ubuntu 22.04 LTS（Local Fossa）/ Ubuntu 18.04 LTS（Bionic Beaver） |

# 3.复现

```
./exploit.sh
```

